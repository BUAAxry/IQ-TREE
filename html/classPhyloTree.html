<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PhyloTree Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PhyloTree Class Reference</h1><!-- doxytag: class="PhyloTree" --><!-- doxytag: inherits="MTree,Optimization" -->
<p><code>#include &lt;<a class="el" href="phylotree_8h_source.html">phylotree.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PhyloTree:</div>
<div class="dynsection">
 <div class="center">
  <img src="classPhyloTree.gif" usemap="#PhyloTree_map" alt=""/>
  <map id="PhyloTree_map" name="PhyloTree_map">
<area href="classMTree.html" alt="MTree" shape="rect" coords="0,0,80,24"/>
<area href="classOptimization.html" alt="Optimization" shape="rect" coords="90,0,170,24"/>
<area href="classIQPTree.html" alt="IQPTree" shape="rect" coords="45,112,125,136"/>
</map>
 </div>
</div>

<p><a href="classPhyloTree-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#ab6e00efe0c10f4a93d34e7d027489ac6">PhyloTree</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#adce7d871ad6fb36424fab1aa2b688f9a">copyTree</a> (<a class="el" href="classMTree.html">MTree</a> *tree)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a195bfdd19700eb12a6680ced3bc5193b">copyPhyloTree</a> (<a class="el" href="classPhyloTree.html">PhyloTree</a> *tree)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a6ea47346f05772215efc900309120428">setAlignment</a> (<a class="el" href="classAlignment.html">Alignment</a> *alignment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a0e90911542265b82a3ed52da08bf9187">setModel</a> (<a class="el" href="classSubstModel.html">SubstModel</a> *amodel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#ad25ae1a621d627f255d9cd8563675165">setRate</a> (<a class="el" href="classRateHeterogeneity.html">RateHeterogeneity</a> *rate)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#afd022a3beda4f24e47b71046d56d4fbf">createModel</a> (<a class="el" href="structParams.html">Params</a> &amp;params)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classNode.html">Node</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a08daeabbb3fa596916aa48834e0b152d">newNode</a> (int node_id=-1, const char *node_name=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classNode.html">Node</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a10e2a1d34d9f9751c42c262e1ef7581e">newNode</a> (int node_id, int node_name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a1dc84a489c3471eff561658ab98a286a">clearAllPartialLh</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a106e4c54e0e3e8d48d3922d205941e60">computeParsimonyScore</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a43540029a0627fb2736464a7def1f846">computeParsimonyScore</a> (int ptn, int &amp;states, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node=NULL, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a3a0f7bf2fc3b545f1ccb6ad2dc8d887c">newPartialLh</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a1c65fd0bcc5b433e6dd4781432aaaccd">computePartialLikelihood</a> (<a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *dad_branch, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a375b6b1fe6d56698b804af890a629869">computeLikelihoodBranch</a> (<a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *dad_branch, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a7d6a388ffa393ccf810e8e04718725ec">computeLikelihood</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a1e1bf7936bb8a7dbacd92f93dad6d531">optimizeModel</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a1c21d2ba4fc8755b3435b5677938a0fb">computeLikelihoodDerv</a> (<a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *dad_branch, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad, double &amp;df, double &amp;ddf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a9537038984ab81f946a6025d5607637e">searchNNI</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a87ed271cb0d09ad3069a20d996c343f9">searchNNI</a> (double cur_score, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node=NULL, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#ad5019f595c9fe481d3eb326bcf10fb03">swapNNI</a> (double cur_score, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a93e28f41404baeca2afcb62f4499a3e1">optimizeOneBranch</a> (<a class="el" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#aaad81a0e6fc24cfb5b665655059bc17b">optimizeChildBranches</a> (<a class="el" href="classPhyloNode.html">PhyloNode</a> *node, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#ab256efc9eb59170ba486c9b6d6d684c7">optimizeAllBranches</a> (<a class="el" href="classPhyloNode.html">PhyloNode</a> *node, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a0d95172300892b57830027c134d7e181">optimizeAllBranches</a> (int iterations=100)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a34c7bdc00d48d66e1a8ebfee9af1f100">computeFunction</a> (double value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a9ae5f61aa0d22976b2d2e8f3ed15f44f">computeFuncDerv</a> (double value, double &amp;df, double &amp;ddf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#acef313906a2021de5de2eb87226a202d">optimizeNNIBranches</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a8927dbf75a06ea797cc76b619759985d">optimizeNNI</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#abd42e1cc3b3da9e0d00ea00182a031d2">optimizeNNI</a> (double cur_score, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node=NULL, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#ab846b2730dd57366d4d5c8412870cd9a">swapNNIBranch</a> (double cur_score, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a2de074f797940b19f9b1e923fe6c814a">growTreeML</a> (<a class="el" href="classAlignment.html">Alignment</a> *alignment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#aa5fdafe246a24235967981a2df3faffb">addTaxonML</a> (<a class="el" href="classNode.html">Node</a> *added_node, <a class="el" href="classNode.html">Node</a> *&amp;target_node, <a class="el" href="classNode.html">Node</a> *&amp;target_dad, <a class="el" href="classNode.html">Node</a> *node, <a class="el" href="classNode.html">Node</a> *dad)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a760299b108adf89646a22ab1ad195cda">computeBioNJ</a> (<a class="el" href="structParams.html">Params</a> &amp;params, <a class="el" href="classAlignment.html">Alignment</a> *alignment, double *&amp;dist_mat)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a80df879587ccb9aa1b9b54103e87ab8a">fixNegativeBranch</a> (<a class="el" href="classNode.html">Node</a> *node=NULL, <a class="el" href="classNode.html">Node</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#ae2a229415387b5eb9f36c3bb078b6d80">optimizeSPR</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a071475b37be90fb615e26b38d72a574f">optimizeSPRBranches</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a726b99499f5a40395fc3c825d2d0a9ad">optimizeSPR</a> (double cur_score, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node=NULL, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a50a289b7af25842a1401856fee67d725">swapSPR</a> (double cur_score, int cur_depth, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad1, <a class="el" href="classPhyloNode.html">PhyloNode</a> *orig_node1, <a class="el" href="classPhyloNode.html">PhyloNode</a> *orig_node2, <a class="el" href="classPhyloNode.html">PhyloNode</a> *node2, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad2, vector&lt; <a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> * &gt; &amp;spr_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a73cd13227a66c17b96465fdc908e069f"></a><!-- doxytag: member="PhyloTree::assessSPRMove" ref="a73cd13227a66c17b96465fdc908e069f" args="(double cur_score, const SPRMove &amp;spr)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>assessSPRMove</b> (double cur_score, const <a class="el" href="structSPRMove.html">SPRMove</a> &amp;spr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2a4ae0ce3b7ac61a7a870280afb85206"></a><!-- doxytag: member="PhyloTree::pruneSubtree" ref="a2a4ae0ce3b7ac61a7a870280afb85206" args="(PhyloNode *node, PhyloNode *dad, PruningInfo &amp;info)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>pruneSubtree</b> (<a class="el" href="classPhyloNode.html">PhyloNode</a> *node, <a class="el" href="classPhyloNode.html">PhyloNode</a> *dad, <a class="el" href="structPruningInfo.html">PruningInfo</a> &amp;info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa87d04899ec1ece927f02dbfa989afbf"></a><!-- doxytag: member="PhyloTree::regraftSubtree" ref="aa87d04899ec1ece927f02dbfa989afbf" args="(PruningInfo &amp;info, PhyloNode *in_node, PhyloNode *in_dad)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>regraftSubtree</b> (<a class="el" href="structPruningInfo.html">PruningInfo</a> &amp;info, <a class="el" href="classPhyloNode.html">PhyloNode</a> *in_node, <a class="el" href="classPhyloNode.html">PhyloNode</a> *in_dad)</td></tr>
<tr><td colspan="2"><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAlignment.html">Alignment</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a155032795a2a06262959ecba6fa1761b">aln</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#ab17482e0cf6b9ea6def40d2c49bf0f3a">optimize_by_newton</a></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a5a35504080c18e60b3a3019c8d457253">assignLeafNames</a> (<a class="el" href="classNode.html">Node</a> *node=NULL, <a class="el" href="classNode.html">Node</a> *dad=NULL)</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSubstModel.html">SubstModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#affd265bc9cd055d0f59bfda46c98387b">model</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRateHeterogeneity.html">RateHeterogeneity</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a9b7513b9bfee50bcd6cbe97a87366c4d">site_rate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a9a11206ad156f382ee0db5f92dd399ce">current_it</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a5016a4372500fe919bfa09b713cd2344">current_it_back</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSPRMoves.html">SPRMoves</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a0ec867545e10bf1a45c938ed5c4a43f1">spr_moves</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhyloTree.html#a63a5b49b525b22534b525d7a35e663c7">spr_radius</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Phylogenetic Tree class</p>
<dl class="author"><dt><b>Author:</b></dt><dd>BUI Quang Minh, Steffen Klaere, Arndt von Haeseler &lt;<a href="mailto:minh.bui@univie.ac.at">minh.bui@univie.ac.at</a>&gt; </dd></dl>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab6e00efe0c10f4a93d34e7d027489ac6"></a><!-- doxytag: member="PhyloTree::PhyloTree" ref="ab6e00efe0c10f4a93d34e7d027489ac6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PhyloTree::PhyloTree </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>constructor </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aa5fdafe246a24235967981a2df3faffb"></a><!-- doxytag: member="PhyloTree::addTaxonML" ref="aa5fdafe246a24235967981a2df3faffb" args="(Node *added_node, Node *&amp;target_node, Node *&amp;target_dad, Node *node, Node *dad)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::addTaxonML </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&nbsp;</td>
          <td class="paramname"> <em>added_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&amp;&nbsp;</td>
          <td class="paramname"> <em>target_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&amp;&nbsp;</td>
          <td class="paramname"> <em>target_dad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>used internally by <a class="el" href="classPhyloTree.html#a2de074f797940b19f9b1e923fe6c814a">growTreeML()</a> to find the best target branch to add into the tree </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>added_node</em>&nbsp;</td><td>node to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target_node</em>&nbsp;</td><td>(OUT) one end of the best branch found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target_dad</em>&nbsp;</td><td>(OUT) the other end of the best branch found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="a5a35504080c18e60b3a3019c8d457253"></a><!-- doxytag: member="PhyloTree::assignLeafNames" ref="a5a35504080c18e60b3a3019c8d457253" args="(Node *node=NULL, Node *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::assignLeafNames </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>assign the leaf names with the alignment sequence names, using the leaf ID for assignment. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the starting node, NULL to start from the root </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1dc84a489c3471eff561658ab98a286a"></a><!-- doxytag: member="PhyloTree::clearAllPartialLh" ref="a1dc84a489c3471eff561658ab98a286a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::clearAllPartialLh </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>clear all partial likelihood for a clean computation again </p>

</div>
</div>
<a class="anchor" id="a760299b108adf89646a22ab1ad195cda"></a><!-- doxytag: member="PhyloTree::computeBioNJ" ref="a760299b108adf89646a22ab1ad195cda" args="(Params &amp;params, Alignment *alignment, double *&amp;dist_mat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::computeBioNJ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParams.html">Params</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAlignment.html">Alignment</a> *&nbsp;</td>
          <td class="paramname"> <em>alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&amp;&nbsp;</td>
          <td class="paramname"> <em>dist_mat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>compute BioNJ tree </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>params</em>&nbsp;</td><td>program parameters </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>alignment</em>&nbsp;</td><td>input alignment </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dist_mat</em>&nbsp;</td><td>(OUT) distance matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9ae5f61aa0d22976b2d2e8f3ed15f44f"></a><!-- doxytag: member="PhyloTree::computeFuncDerv" ref="a9ae5f61aa0d22976b2d2e8f3ed15f44f" args="(double value, double &amp;df, double &amp;ddf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::computeFuncDerv </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>ddf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Inherited from <a class="el" href="classOptimization.html">Optimization</a> class. This function calculate f(value), first derivative f'(value) and 2nd derivative f''(value). used by Newton raphson method to minimize the function. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>current branch length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>df</em>&nbsp;</td><td>(OUT) first derivative </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ddf</em>&nbsp;</td><td>(OUT) second derivative </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>negative of likelihood (for minimization) </dd></dl>

<p>Reimplemented from <a class="el" href="classOptimization.html#a18bedacde6fd259ff5923c9e936464bd">Optimization</a>.</p>

</div>
</div>
<a class="anchor" id="a34c7bdc00d48d66e1a8ebfee9af1f100"></a><!-- doxytag: member="PhyloTree::computeFunction" ref="a34c7bdc00d48d66e1a8ebfee9af1f100" args="(double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::computeFunction </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>value</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>inherited from <a class="el" href="classOptimization.html">Optimization</a> class, to return to likelihood of the tree when the current branch length is set to value </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>current branch length </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>negative of likelihood (for minimization) </dd></dl>

<p>Reimplemented from <a class="el" href="classOptimization.html#ad7ca7b884076f8c76312d516e23c6609">Optimization</a>.</p>

</div>
</div>
<a class="anchor" id="a7d6a388ffa393ccf810e8e04718725ec"></a><!-- doxytag: member="PhyloTree::computeLikelihood" ref="a7d6a388ffa393ccf810e8e04718725ec" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::computeLikelihood </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>compute the tree likelihood </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>tree likelihood </dd></dl>

</div>
</div>
<a class="anchor" id="a375b6b1fe6d56698b804af890a629869"></a><!-- doxytag: member="PhyloTree::computeLikelihoodBranch" ref="a375b6b1fe6d56698b804af890a629869" args="(PhyloNeighbor *dad_branch, PhyloNode *dad)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::computeLikelihoodBranch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *&nbsp;</td>
          <td class="paramname"> <em>dad_branch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>compute tree likelihood on a branch. used to optimize branch length </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dad_branch</em>&nbsp;</td><td>the branch leading to the subtree </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>its dad, used to direct the tranversal </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>tree likelihood </dd></dl>

</div>
</div>
<a class="anchor" id="a1c21d2ba4fc8755b3435b5677938a0fb"></a><!-- doxytag: member="PhyloTree::computeLikelihoodDerv" ref="a1c21d2ba4fc8755b3435b5677938a0fb" args="(PhyloNeighbor *dad_branch, PhyloNode *dad, double &amp;df, double &amp;ddf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::computeLikelihoodDerv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *&nbsp;</td>
          <td class="paramname"> <em>dad_branch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>ddf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>compute tree likelihood and derivatives on a branch. used to optimize branch length </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dad_branch</em>&nbsp;</td><td>the branch leading to the subtree </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>its dad, used to direct the tranversal </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>df</em>&nbsp;</td><td>(OUT) first derivative </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ddf</em>&nbsp;</td><td>(OUT) second derivative </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>tree likelihood </dd></dl>

</div>
</div>
<a class="anchor" id="a43540029a0627fb2736464a7def1f846"></a><!-- doxytag: member="PhyloTree::computeParsimonyScore" ref="a43540029a0627fb2736464a7def1f846" args="(int ptn, int &amp;states, PhyloNode *node=NULL, PhyloNode *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PhyloTree::computeParsimonyScore </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ptn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&nbsp;</td>
          <td class="paramname"> <em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>compute the parsimony score of the tree, given the alignment </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the parsimony score </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ptn</em>&nbsp;</td><td>pattern ID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>states</em>&nbsp;</td><td>set of admissible states at the current node (in binary code) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a106e4c54e0e3e8d48d3922d205941e60"></a><!-- doxytag: member="PhyloTree::computeParsimonyScore" ref="a106e4c54e0e3e8d48d3922d205941e60" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PhyloTree::computeParsimonyScore </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this function return the parsimony or likelihood score of the tree. Default is to compute the parsimony score. Override this function if you define a new score function. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the tree score compute the parsimony score of the tree, given the alignment </dd>
<dd>
the parsimony score </dd></dl>

</div>
</div>
<a class="anchor" id="a1c65fd0bcc5b433e6dd4781432aaaccd"></a><!-- doxytag: member="PhyloTree::computePartialLikelihood" ref="a1c65fd0bcc5b433e6dd4781432aaaccd" args="(PhyloNeighbor *dad_branch, PhyloNode *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::computePartialLikelihood </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> *&nbsp;</td>
          <td class="paramname"> <em>dad_branch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>compute the partial likelihood at a subtree </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dad_branch</em>&nbsp;</td><td>the branch leading to the subtree </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>its dad, used to direct the tranversal </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a195bfdd19700eb12a6680ced3bc5193b"></a><!-- doxytag: member="PhyloTree::copyPhyloTree" ref="a195bfdd19700eb12a6680ced3bc5193b" args="(PhyloTree *tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::copyPhyloTree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPhyloTree.html">PhyloTree</a> *&nbsp;</td>
          <td class="paramname"> <em>tree</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>copy the phylogenetic tree structure into this tree, designed specifically for <a class="el" href="classPhyloTree.html">PhyloTree</a>. So there is some distinction with copyTree. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tree</em>&nbsp;</td><td>the tree to copy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adce7d871ad6fb36424fab1aa2b688f9a"></a><!-- doxytag: member="PhyloTree::copyTree" ref="adce7d871ad6fb36424fab1aa2b688f9a" args="(MTree *tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::copyTree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMTree.html">MTree</a> *&nbsp;</td>
          <td class="paramname"> <em>tree</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>copy the phylogenetic tree structure into this tree, override to take sequence names in the alignment into account </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tree</em>&nbsp;</td><td>the tree to copy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afd022a3beda4f24e47b71046d56d4fbf"></a><!-- doxytag: member="PhyloTree::createModel" ref="afd022a3beda4f24e47b71046d56d4fbf" args="(Params &amp;params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::createModel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParams.html">Params</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>params</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>create substitution model with possible rate heterogeneity. Create proper class objects for two variables: model and site_rate. It takes the following field of params into account: model_name, num_rate_cats, freq_type </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>params</em>&nbsp;</td><td>program parameters </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a80df879587ccb9aa1b9b54103e87ab8a"></a><!-- doxytag: member="PhyloTree::fixNegativeBranch" ref="a80df879587ccb9aa1b9b54103e87ab8a" args="(Node *node=NULL, Node *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::fixNegativeBranch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Neighbor-joining tree might contain negative branch length. This function will fix this. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2de074f797940b19f9b1e923fe6c814a"></a><!-- doxytag: member="PhyloTree::growTreeML" ref="a2de074f797940b19f9b1e923fe6c814a" args="(Alignment *alignment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::growTreeML </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAlignment.html">Alignment</a> *&nbsp;</td>
          <td class="paramname"> <em>alignment</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>grow the tree by step-wise addition </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>alignment</em>&nbsp;</td><td>input alignment </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a10e2a1d34d9f9751c42c262e1ef7581e"></a><!-- doxytag: member="PhyloTree::newNode" ref="a10e2a1d34d9f9751c42c262e1ef7581e" args="(int node_id, int node_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNode.html">Node</a> * PhyloTree::newNode </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>node_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>node_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>allocate a new node. Override this if you have an inherited <a class="el" href="classNode.html">Node</a> class. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node_id</em>&nbsp;</td><td>node ID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node_name</em>&nbsp;</td><td>node name issued by an interger </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a new node </dd></dl>

<p>Reimplemented from <a class="el" href="classMTree.html">MTree</a>.</p>

</div>
</div>
<a class="anchor" id="a08daeabbb3fa596916aa48834e0b152d"></a><!-- doxytag: member="PhyloTree::newNode" ref="a08daeabbb3fa596916aa48834e0b152d" args="(int node_id=&#45;1, const char *node_name=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNode.html">Node</a> * PhyloTree::newNode </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>node_id</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>node_name</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>allocate a new node. Override this if you have an inherited <a class="el" href="classNode.html">Node</a> class. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node_id</em>&nbsp;</td><td>node ID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node_name</em>&nbsp;</td><td>node name </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a new node </dd></dl>

<p>Reimplemented from <a class="el" href="classMTree.html#a5e9560ad6b544027bea362387eb2ec3f">MTree</a>.</p>

</div>
</div>
<a class="anchor" id="a3a0f7bf2fc3b545f1ccb6ad2dc8d887c"></a><!-- doxytag: member="PhyloTree::newPartialLh" ref="a3a0f7bf2fc3b545f1ccb6ad2dc8d887c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double * PhyloTree::newPartialLh </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>allocate memory for a partial likelihood vector </p>

</div>
</div>
<a class="anchor" id="a0d95172300892b57830027c134d7e181"></a><!-- doxytag: member="PhyloTree::optimizeAllBranches" ref="a0d95172300892b57830027c134d7e181" args="(int iterations=100)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeAllBranches </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>iterations</em> = <code>100</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>optimize all branch lengths of the tree </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterations</em>&nbsp;</td><td>number of iterations to loop through all branches </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="ab256efc9eb59170ba486c9b6d6d684c7"></a><!-- doxytag: member="PhyloTree::optimizeAllBranches" ref="ab256efc9eb59170ba486c9b6d6d684c7" args="(PhyloNode *node, PhyloNode *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeAllBranches </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>optimize all branch lengths at the subtree rooted at node step-by-step. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="aaad81a0e6fc24cfb5b665655059bc17b"></a><!-- doxytag: member="PhyloTree::optimizeChildBranches" ref="aaad81a0e6fc24cfb5b665655059bc17b" args="(PhyloNode *node, PhyloNode *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeChildBranches </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>optimize all branch lengths of the children of node </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="a1e1bf7936bb8a7dbacd92f93dad6d531"></a><!-- doxytag: member="PhyloTree::optimizeModel" ref="a1e1bf7936bb8a7dbacd92f93dad6d531" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeModel </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>optimize model parameters and tree branch lengths </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the best likelihood </dd></dl>

</div>
</div>
<a class="anchor" id="abd42e1cc3b3da9e0d00ea00182a031d2"></a><!-- doxytag: member="PhyloTree::optimizeNNI" ref="abd42e1cc3b3da9e0d00ea00182a031d2" args="(double cur_score, PhyloNode *node=NULL, PhyloNode *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeNNI </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cur_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by a nearest neigbor interchange </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cur_score</em>&nbsp;</td><td>current likelihood score </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="a8927dbf75a06ea797cc76b619759985d"></a><!-- doxytag: member="PhyloTree::optimizeNNI" ref="a8927dbf75a06ea797cc76b619759985d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeNNI </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by a nearest neigbor interchange </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

<p>Reimplemented in <a class="el" href="classIQPTree.html#a8d1a63f976a3a219bc8a23ed356e1d65">IQPTree</a>.</p>

</div>
</div>
<a class="anchor" id="acef313906a2021de5de2eb87226a202d"></a><!-- doxytag: member="PhyloTree::optimizeNNIBranches" ref="acef313906a2021de5de2eb87226a202d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeNNIBranches </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by a nearest neigbor interchange, then optimize branch lengths. Do it until tree does not improve </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="a93e28f41404baeca2afcb62f4499a3e1"></a><!-- doxytag: member="PhyloTree::optimizeOneBranch" ref="a93e28f41404baeca2afcb62f4499a3e1" args="(PhyloNode *node1, PhyloNode *node2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeOneBranch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>optimize one branch length by ML </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node1</em>&nbsp;</td><td>1st end node of the branch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node2</em>&nbsp;</td><td>2nd end node of the branch </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>likelihood score </dd></dl>

</div>
</div>
<a class="anchor" id="a726b99499f5a40395fc3c825d2d0a9ad"></a><!-- doxytag: member="PhyloTree::optimizeSPR" ref="a726b99499f5a40395fc3c825d2d0a9ad" args="(double cur_score, PhyloNode *node=NULL, PhyloNode *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeSPR </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cur_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by Subtree pruning and regrafting at a current subtree </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cur_score</em>&nbsp;</td><td>current likelihood score </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="ae2a229415387b5eb9f36c3bb078b6d80"></a><!-- doxytag: member="PhyloTree::optimizeSPR" ref="ae2a229415387b5eb9f36c3bb078b6d80" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeSPR </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by Subtree pruning and regrafting </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="a071475b37be90fb615e26b38d72a574f"></a><!-- doxytag: member="PhyloTree::optimizeSPRBranches" ref="a071475b37be90fb615e26b38d72a574f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::optimizeSPRBranches </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by Subtree pruning and regrafting, then optimize branch lengths. Iterative until no tree improvement found. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="a87ed271cb0d09ad3069a20d996c343f9"></a><!-- doxytag: member="PhyloTree::searchNNI" ref="a87ed271cb0d09ad3069a20d996c343f9" args="(double cur_score, PhyloNode *node=NULL, PhyloNode *dad=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::searchNNI </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cur_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by a nearest neigbor interchange with parsimony </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>node</em>&nbsp;</td><td>the current node </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dad</em>&nbsp;</td><td>dad of the node, used to direct the search </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cur_score</em>&nbsp;</td><td>current score </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>best score </dd></dl>

</div>
</div>
<a class="anchor" id="a9537038984ab81f946a6025d5607637e"></a><!-- doxytag: member="PhyloTree::searchNNI" ref="a9537038984ab81f946a6025d5607637e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::searchNNI </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>search by a nearest neigbor interchange with parsimony </p>

</div>
</div>
<a class="anchor" id="a6ea47346f05772215efc900309120428"></a><!-- doxytag: member="PhyloTree::setAlignment" ref="a6ea47346f05772215efc900309120428" args="(Alignment *alignment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::setAlignment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAlignment.html">Alignment</a> *&nbsp;</td>
          <td class="paramname"> <em>alignment</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>set the alignment, important to compute parsimony or likelihood score </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>alignment</em>&nbsp;</td><td>associated alignment </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0e90911542265b82a3ed52da08bf9187"></a><!-- doxytag: member="PhyloTree::setModel" ref="a0e90911542265b82a3ed52da08bf9187" args="(SubstModel *amodel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::setModel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSubstModel.html">SubstModel</a> *&nbsp;</td>
          <td class="paramname"> <em>amodel</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>set the substitution model, important to compute the likelihood </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>amodel</em>&nbsp;</td><td>associated substitution model </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad25ae1a621d627f255d9cd8563675165"></a><!-- doxytag: member="PhyloTree::setRate" ref="ad25ae1a621d627f255d9cd8563675165" args="(RateHeterogeneity *rate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PhyloTree::setRate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRateHeterogeneity.html">RateHeterogeneity</a> *&nbsp;</td>
          <td class="paramname"> <em>rate</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>set rate heterogeneity, important to compute the likelihood </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rate</em>&nbsp;</td><td>associated rate heterogeneity class </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad5019f595c9fe481d3eb326bcf10fb03"></a><!-- doxytag: member="PhyloTree::swapNNI" ref="ad5019f595c9fe481d3eb326bcf10fb03" args="(double cur_score, PhyloNode *node1, PhyloNode *node2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::swapNNI </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cur_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>try to swap the tree with nearest neigbor interchange at the branch connecting node1-node2. If a swap shows better score, return the swapped tree and the score. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cur_score</em>&nbsp;</td><td>current score </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node1</em>&nbsp;</td><td>1st end node of the branch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node2</em>&nbsp;</td><td>2nd end node of the branch </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>best score </dd></dl>

</div>
</div>
<a class="anchor" id="ab846b2730dd57366d4d5c8412870cd9a"></a><!-- doxytag: member="PhyloTree::swapNNIBranch" ref="ab846b2730dd57366d4d5c8412870cd9a" args="(double cur_score, PhyloNode *node1, PhyloNode *node2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::swapNNIBranch </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cur_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is for ML. try to swap the tree with nearest neigbor interchange at the branch connecting node1-node2. If a swap shows better score, return the swapped tree and the score. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cur_score</em>&nbsp;</td><td>current likelihood score </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node1</em>&nbsp;</td><td>1st end node of the branch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>node2</em>&nbsp;</td><td>2nd end node of the branch </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the likelihood of the tree </dd></dl>

</div>
</div>
<a class="anchor" id="a50a289b7af25842a1401856fee67d725"></a><!-- doxytag: member="PhyloTree::swapSPR" ref="a50a289b7af25842a1401856fee67d725" args="(double cur_score, int cur_depth, PhyloNode *node1, PhyloNode *dad1, PhyloNode *orig_node1, PhyloNode *orig_node2, PhyloNode *node2, PhyloNode *dad2, vector&lt; PhyloNeighbor * &gt; &amp;spr_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PhyloTree::swapSPR </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cur_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cur_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>orig_node1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>orig_node2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPhyloNode.html">PhyloNode</a> *&nbsp;</td>
          <td class="paramname"> <em>dad2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>spr_path</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>move the subtree (dad1-node1) to the branch (dad2-node2) </p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a155032795a2a06262959ecba6fa1761b"></a><!-- doxytag: member="PhyloTree::aln" ref="a155032795a2a06262959ecba6fa1761b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAlignment.html">Alignment</a>* <a class="el" href="classPhyloTree.html#a155032795a2a06262959ecba6fa1761b">PhyloTree::aln</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>associated alignment </p>

</div>
</div>
<a class="anchor" id="a9a11206ad156f382ee0db5f92dd399ce"></a><!-- doxytag: member="PhyloTree::current_it" ref="a9a11206ad156f382ee0db5f92dd399ce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a>* <a class="el" href="classPhyloTree.html#a9a11206ad156f382ee0db5f92dd399ce">PhyloTree::current_it</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>current branch iterator, used by <a class="el" href="classPhyloTree.html#a34c7bdc00d48d66e1a8ebfee9af1f100">computeFunction()</a> to optimize branch lengths </p>

</div>
</div>
<a class="anchor" id="a5016a4372500fe919bfa09b713cd2344"></a><!-- doxytag: member="PhyloTree::current_it_back" ref="a5016a4372500fe919bfa09b713cd2344" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPhyloNeighbor.html">PhyloNeighbor</a>* <a class="el" href="classPhyloTree.html#a5016a4372500fe919bfa09b713cd2344">PhyloTree::current_it_back</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>current branch iterator of the other end, used by <a class="el" href="classPhyloTree.html#a34c7bdc00d48d66e1a8ebfee9af1f100">computeFunction()</a> to optimize branch lengths </p>

</div>
</div>
<a class="anchor" id="affd265bc9cd055d0f59bfda46c98387b"></a><!-- doxytag: member="PhyloTree::model" ref="affd265bc9cd055d0f59bfda46c98387b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSubstModel.html">SubstModel</a>* <a class="el" href="classPhyloTree.html#affd265bc9cd055d0f59bfda46c98387b">PhyloTree::model</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>associated substitution model </p>

</div>
</div>
<a class="anchor" id="ab17482e0cf6b9ea6def40d2c49bf0f3a"></a><!-- doxytag: member="PhyloTree::optimize_by_newton" ref="ab17482e0cf6b9ea6def40d2c49bf0f3a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPhyloTree.html#ab17482e0cf6b9ea6def40d2c49bf0f3a">PhyloTree::optimize_by_newton</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>TRUE if you want to optimize branch lengths by Newton-Raphson method </p>

</div>
</div>
<a class="anchor" id="a9b7513b9bfee50bcd6cbe97a87366c4d"></a><!-- doxytag: member="PhyloTree::site_rate" ref="a9b7513b9bfee50bcd6cbe97a87366c4d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRateHeterogeneity.html">RateHeterogeneity</a>* <a class="el" href="classPhyloTree.html#a9b7513b9bfee50bcd6cbe97a87366c4d">PhyloTree::site_rate</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>among-site rates </p>

</div>
</div>
<a class="anchor" id="a0ec867545e10bf1a45c938ed5c4a43f1"></a><!-- doxytag: member="PhyloTree::spr_moves" ref="a0ec867545e10bf1a45c938ed5c4a43f1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSPRMoves.html">SPRMoves</a> <a class="el" href="classPhyloTree.html#a0ec867545e10bf1a45c938ed5c4a43f1">PhyloTree::spr_moves</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>spr moves </p>

</div>
</div>
<a class="anchor" id="a63a5b49b525b22534b525d7a35e663c7"></a><!-- doxytag: member="PhyloTree::spr_radius" ref="a63a5b49b525b22534b525d7a35e663c7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPhyloTree.html#a63a5b49b525b22534b525d7a35e663c7">PhyloTree::spr_radius</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SPR radius </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="phylotree_8h_source.html">phylotree.h</a></li>
<li>src/phylotree.cpp</li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Nov 26 16:11:50 2009 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
