<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>src/phylotree.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>src/phylotree.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">// C++ Interface: phylotree</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// Description: </span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00007"></a>00007 <span class="comment">// Author: BUI Quang Minh, Steffen Klaere, Arndt von Haeseler &lt;minh.bui@univie.ac.at&gt;, (C) 2008</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">// Copyright: See COPYING file that comes with this distribution</span>
<a name="l00010"></a>00010 <span class="comment">//</span>
<a name="l00011"></a>00011 <span class="comment">//</span>
<a name="l00012"></a>00012 <span class="preprocessor">#ifndef PHYLOTREE_H</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor">#define PHYLOTREE_H</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;mtree.h&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;alignment.h&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;substmodel.h&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;phylonode.h&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;optimization.h&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;rateheterogeneity.h&quot;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_SPR_MOVES = 20;
<a name="l00023"></a>00023 
<a name="l00027"></a><a class="code" href="structSPRMove.html">00027</a> <span class="keyword">struct </span><a class="code" href="structSPRMove.html">SPRMove</a> {
<a name="l00028"></a>00028         <a class="code" href="classPhyloNode.html">PhyloNode</a> *prune_dad;
<a name="l00029"></a>00029         <a class="code" href="classPhyloNode.html">PhyloNode</a> *prune_node;
<a name="l00030"></a>00030         <a class="code" href="classPhyloNode.html">PhyloNode</a> *regraft_dad;
<a name="l00031"></a>00031         <a class="code" href="classPhyloNode.html">PhyloNode</a> *regraft_node;
<a name="l00032"></a>00032         <span class="keywordtype">double</span> score;
<a name="l00033"></a>00033 };
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="structSPR__compare.html">00035</a> <span class="keyword">struct </span><a class="code" href="structSPR__compare.html">SPR_compare</a>
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037   <span class="keywordtype">bool</span> operator()(<a class="code" href="structSPRMove.html">SPRMove</a> s1, <a class="code" href="structSPRMove.html">SPRMove</a> s2)<span class="keyword"> const</span>
<a name="l00038"></a>00038 <span class="keyword">  </span>{
<a name="l00039"></a>00039     <span class="keywordflow">return</span> s1.score &gt; s2.score;
<a name="l00040"></a>00040   }
<a name="l00041"></a>00041 };
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="classSPRMoves.html">00043</a> <span class="keyword">class </span><a class="code" href="classSPRMoves.html">SPRMoves</a> : <span class="keyword">public</span> set&lt;SPRMove, SPR_compare&gt; {
<a name="l00044"></a>00044 <span class="keyword">public</span>:
<a name="l00045"></a>00045         <span class="keywordtype">void</span> add(<a class="code" href="classPhyloNode.html">PhyloNode</a> *prune_node, <a class="code" href="classPhyloNode.html">PhyloNode</a> *prune_dad, 
<a name="l00046"></a>00046                 <a class="code" href="classPhyloNode.html">PhyloNode</a> *regraft_node, <a class="code" href="classPhyloNode.html">PhyloNode</a> *regraft_dad, <span class="keywordtype">double</span> score);
<a name="l00047"></a>00047 };
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">/*</span>
<a name="l00051"></a>00051 <span class="comment">left_node-----------dad-----------right_node</span>
<a name="l00052"></a>00052 <span class="comment">                     |</span>
<a name="l00053"></a>00053 <span class="comment">                     |</span>
<a name="l00054"></a>00054 <span class="comment">                     |</span>
<a name="l00055"></a>00055 <span class="comment">                    node</span>
<a name="l00056"></a>00056 <span class="comment">*/</span>
<a name="l00057"></a><a class="code" href="structPruningInfo.html">00057</a> <span class="keyword">struct </span><a class="code" href="structPruningInfo.html">PruningInfo</a> {
<a name="l00058"></a>00058         NeighborVec::iterator dad_it_left, dad_it_right, left_it, right_it;
<a name="l00059"></a>00059         <a class="code" href="classNeighbor.html">Neighbor</a> *dad_nei_left, *dad_nei_right, *left_nei, *right_nei;
<a name="l00060"></a>00060         <a class="code" href="classNode.html">Node</a> *node, *dad, *left_node, *right_node;
<a name="l00061"></a>00061         <span class="keywordtype">double</span> left_len, right_len;
<a name="l00062"></a>00062         <span class="keywordtype">double</span> *dad_lh_left, *dad_lh_right;
<a name="l00063"></a>00063         
<a name="l00064"></a>00064 };
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 
<a name="l00072"></a><a class="code" href="classPhyloTree.html">00072</a> <span class="keyword">class </span><a class="code" href="classPhyloTree.html">PhyloTree</a> : <span class="keyword">public</span> <a class="code" href="classMTree.html">MTree</a>, <span class="keyword">public</span> <a class="code" href="classOptimization.html">Optimization</a>
<a name="l00073"></a>00073 {
<a name="l00074"></a>00074 <span class="keyword">public</span>:
<a name="l00075"></a>00075 
<a name="l00079"></a>00079         <a class="code" href="classPhyloTree.html#ab6e00efe0c10f4a93d34e7d027489ac6">PhyloTree</a>();
<a name="l00080"></a>00080 
<a name="l00086"></a>00086         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#adce7d871ad6fb36424fab1aa2b688f9a">copyTree</a>(<a class="code" href="classMTree.html">MTree</a> *tree);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088         
<a name="l00094"></a>00094         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a195bfdd19700eb12a6680ced3bc5193b">copyPhyloTree</a>(<a class="code" href="classPhyloTree.html">PhyloTree</a> *tree);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00101"></a>00101     <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a6ea47346f05772215efc900309120428">setAlignment</a>(<a class="code" href="classAlignment.html">Alignment</a> *alignment);
<a name="l00102"></a>00102 
<a name="l00107"></a>00107         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a0e90911542265b82a3ed52da08bf9187">setModel</a>(<a class="code" href="classSubstModel.html">SubstModel</a> *amodel);
<a name="l00108"></a>00108 
<a name="l00113"></a>00113         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#ad25ae1a621d627f255d9cd8563675165">setRate</a>(<a class="code" href="classRateHeterogeneity.html">RateHeterogeneity</a> *rate);
<a name="l00114"></a>00114 
<a name="l00121"></a>00121         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#afd022a3beda4f24e47b71046d56d4fbf">createModel</a>(<a class="code" href="structParams.html">Params</a> &amp;params);
<a name="l00122"></a>00122 
<a name="l00129"></a>00129         <span class="keyword">virtual</span> <a class="code" href="classNode.html">Node</a>* <a class="code" href="classPhyloTree.html#a08daeabbb3fa596916aa48834e0b152d">newNode</a>(<span class="keywordtype">int</span> node_id = -1, <span class="keyword">const</span> <span class="keywordtype">char</span>* node_name = NULL);
<a name="l00130"></a>00130 
<a name="l00137"></a>00137         <span class="keyword">virtual</span> <a class="code" href="classNode.html">Node</a>* <a class="code" href="classPhyloTree.html#a08daeabbb3fa596916aa48834e0b152d">newNode</a>(<span class="keywordtype">int</span> node_id, <span class="keywordtype">int</span> node_name);
<a name="l00138"></a>00138 
<a name="l00142"></a>00142         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a1dc84a489c3471eff561658ab98a286a">clearAllPartialLh</a>();
<a name="l00143"></a>00143 
<a name="l00150"></a>00150         <span class="comment">//virtual double computeScore() { return -computeLikelihood(); }</span>
<a name="l00151"></a>00151         <span class="comment">//virtual double computeScore() { return (double)computeParsimonyScore(); }</span>
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">/****************************************************************************</span>
<a name="l00154"></a>00154 <span class="comment">        Parsimony function</span>
<a name="l00155"></a>00155 <span class="comment">****************************************************************************/</span>
<a name="l00156"></a>00156 
<a name="l00161"></a>00161         <span class="keywordtype">int</span> <a class="code" href="classPhyloTree.html#a106e4c54e0e3e8d48d3922d205941e60">computeParsimonyScore</a>();
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 
<a name="l00172"></a>00172         <span class="keywordtype">int</span> <a class="code" href="classPhyloTree.html#a106e4c54e0e3e8d48d3922d205941e60">computeParsimonyScore</a>(<span class="keywordtype">int</span> ptn, <span class="keywordtype">int</span> &amp;states, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node = NULL, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad = NULL);
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">/****************************************************************************</span>
<a name="l00176"></a>00176 <span class="comment">        likelihood function</span>
<a name="l00177"></a>00177 <span class="comment">****************************************************************************/</span>
<a name="l00178"></a>00178 
<a name="l00182"></a>00182         <span class="keywordtype">double</span> *<a class="code" href="classPhyloTree.html#a3a0f7bf2fc3b545f1ccb6ad2dc8d887c">newPartialLh</a>();
<a name="l00183"></a>00183 
<a name="l00189"></a>00189         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a1c65fd0bcc5b433e6dd4781432aaaccd">computePartialLikelihood</a>(<a class="code" href="classPhyloNeighbor.html">PhyloNeighbor</a> *dad_branch, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad = NULL);
<a name="l00190"></a>00190 
<a name="l00197"></a>00197         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a375b6b1fe6d56698b804af890a629869">computeLikelihoodBranch</a>(<a class="code" href="classPhyloNeighbor.html">PhyloNeighbor</a> *dad_branch, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad);
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 
<a name="l00204"></a>00204         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a7d6a388ffa393ccf810e8e04718725ec">computeLikelihood</a>();
<a name="l00205"></a>00205 
<a name="l00210"></a>00210         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a1e1bf7936bb8a7dbacd92f93dad6d531">optimizeModel</a>();
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="comment">/****************************************************************************</span>
<a name="l00213"></a>00213 <span class="comment">        computing derivatives of likelihood function</span>
<a name="l00214"></a>00214 <span class="comment">****************************************************************************/</span>
<a name="l00223"></a>00223         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a1c21d2ba4fc8755b3435b5677938a0fb">computeLikelihoodDerv</a>(<a class="code" href="classPhyloNeighbor.html">PhyloNeighbor</a> *dad_branch, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad, <span class="keywordtype">double</span> &amp;df, <span class="keywordtype">double</span> &amp;ddf);
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="comment">/****************************************************************************</span>
<a name="l00227"></a>00227 <span class="comment">        Nearest Neighbor Interchange with parsimony</span>
<a name="l00228"></a>00228 <span class="comment">****************************************************************************/</span>
<a name="l00232"></a>00232         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a9537038984ab81f946a6025d5607637e">searchNNI</a>();
<a name="l00233"></a>00233 
<a name="l00241"></a>00241         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a9537038984ab81f946a6025d5607637e">searchNNI</a>(<span class="keywordtype">double</span> cur_score, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node = NULL, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad = NULL);
<a name="l00242"></a>00242 
<a name="l00251"></a>00251         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#ad5019f595c9fe481d3eb326bcf10fb03">swapNNI</a>(<span class="keywordtype">double</span> cur_score, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node2);
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">/****************************************************************************</span>
<a name="l00254"></a>00254 <span class="comment">        Branch length optimization by maximum likelihood</span>
<a name="l00255"></a>00255 <span class="comment">****************************************************************************/</span>
<a name="l00256"></a>00256 
<a name="l00263"></a>00263         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a93e28f41404baeca2afcb62f4499a3e1">optimizeOneBranch</a>(<a class="code" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node2);
<a name="l00264"></a>00264 
<a name="l00271"></a>00271         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#aaad81a0e6fc24cfb5b665655059bc17b">optimizeChildBranches</a>(<a class="code" href="classPhyloNode.html">PhyloNode</a> *node, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad = NULL);
<a name="l00272"></a>00272 
<a name="l00279"></a>00279         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#ab256efc9eb59170ba486c9b6d6d684c7">optimizeAllBranches</a>(<a class="code" href="classPhyloNode.html">PhyloNode</a> *node, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad = NULL);
<a name="l00280"></a>00280 
<a name="l00286"></a>00286         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#ab256efc9eb59170ba486c9b6d6d684c7">optimizeAllBranches</a>(<span class="keywordtype">int</span> iterations = 100);
<a name="l00287"></a>00287 
<a name="l00294"></a>00294         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a34c7bdc00d48d66e1a8ebfee9af1f100">computeFunction</a>(<span class="keywordtype">double</span> value);
<a name="l00295"></a>00295 
<a name="l00305"></a>00305         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a9ae5f61aa0d22976b2d2e8f3ed15f44f">computeFuncDerv</a>(<span class="keywordtype">double</span> value, <span class="keywordtype">double</span> &amp;df, <span class="keywordtype">double</span> &amp;ddf);
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="comment">/****************************************************************************</span>
<a name="l00309"></a>00309 <span class="comment">        Nearest Neighbor Interchange by maximum likelihood</span>
<a name="l00310"></a>00310 <span class="comment">****************************************************************************/</span>
<a name="l00311"></a>00311 
<a name="l00317"></a>00317         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#acef313906a2021de5de2eb87226a202d">optimizeNNIBranches</a>();
<a name="l00318"></a>00318 
<a name="l00323"></a>00323         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a8927dbf75a06ea797cc76b619759985d">optimizeNNI</a>();
<a name="l00324"></a>00324 
<a name="l00332"></a>00332         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a8927dbf75a06ea797cc76b619759985d">optimizeNNI</a>(<span class="keywordtype">double</span> cur_score, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node = NULL, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad = NULL);
<a name="l00333"></a>00333 
<a name="l00342"></a>00342         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#ab846b2730dd57366d4d5c8412870cd9a">swapNNIBranch</a>(<span class="keywordtype">double</span> cur_score, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node2);
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 
<a name="l00345"></a>00345 <span class="comment">/****************************************************************************</span>
<a name="l00346"></a>00346 <span class="comment">        Stepwise addition (greedy) by maximum likelihood</span>
<a name="l00347"></a>00347 <span class="comment">****************************************************************************/</span>
<a name="l00348"></a>00348 
<a name="l00353"></a>00353         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a2de074f797940b19f9b1e923fe6c814a">growTreeML</a>(<a class="code" href="classAlignment.html">Alignment</a> *alignment);
<a name="l00354"></a>00354 
<a name="l00364"></a>00364         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#aa5fdafe246a24235967981a2df3faffb">addTaxonML</a>(<a class="code" href="classNode.html">Node</a> *added_node, <a class="code" href="classNode.html">Node</a>* &amp;target_node, <a class="code" href="classNode.html">Node</a>* &amp;target_dad, <a class="code" href="classNode.html">Node</a> *node, <a class="code" href="classNode.html">Node</a> *dad);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="comment">/****************************************************************************</span>
<a name="l00367"></a>00367 <span class="comment">        compute BioNJ tree, a more accurate extension of Neighbor-Joining</span>
<a name="l00368"></a>00368 <span class="comment">****************************************************************************/</span>
<a name="l00369"></a>00369 
<a name="l00376"></a>00376         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a760299b108adf89646a22ab1ad195cda">computeBioNJ</a>(<a class="code" href="structParams.html">Params</a> &amp;params, <a class="code" href="classAlignment.html">Alignment</a> *alignment, <span class="keywordtype">double</span>* &amp;dist_mat);
<a name="l00377"></a>00377 
<a name="l00384"></a>00384         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a80df879587ccb9aa1b9b54103e87ab8a">fixNegativeBranch</a>(<a class="code" href="classNode.html">Node</a> *node = NULL, <a class="code" href="classNode.html">Node</a> *dad = NULL);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 <span class="comment">/****************************************************************************</span>
<a name="l00388"></a>00388 <span class="comment">        Subtree Pruning and Regrafting by maximum likelihood</span>
<a name="l00389"></a>00389 <span class="comment">        NOTE: NOT DONE YET</span>
<a name="l00390"></a>00390 <span class="comment">****************************************************************************/</span>
<a name="l00391"></a>00391         
<a name="l00396"></a>00396         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#ae2a229415387b5eb9f36c3bb078b6d80">optimizeSPR</a>();
<a name="l00397"></a>00397 
<a name="l00403"></a>00403         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a071475b37be90fb615e26b38d72a574f">optimizeSPRBranches</a>();
<a name="l00404"></a>00404 
<a name="l00412"></a>00412         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#ae2a229415387b5eb9f36c3bb078b6d80">optimizeSPR</a>(<span class="keywordtype">double</span> cur_score, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node = NULL, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad = NULL);
<a name="l00413"></a>00413 
<a name="l00417"></a>00417         <span class="keywordtype">double</span> <a class="code" href="classPhyloTree.html#a50a289b7af25842a1401856fee67d725">swapSPR</a>(<span class="keywordtype">double</span> cur_score, <span class="keywordtype">int</span> cur_depth, <a class="code" href="classPhyloNode.html">PhyloNode</a> *node1, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad1, 
<a name="l00418"></a>00418                 <a class="code" href="classPhyloNode.html">PhyloNode</a> *orig_node1, <a class="code" href="classPhyloNode.html">PhyloNode</a> *orig_node2,
<a name="l00419"></a>00419                 <a class="code" href="classPhyloNode.html">PhyloNode</a> *node2, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad2, vector&lt;PhyloNeighbor*&gt; &amp;spr_path);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="keywordtype">double</span> assessSPRMove(<span class="keywordtype">double</span> cur_score, <span class="keyword">const</span> <a class="code" href="structSPRMove.html">SPRMove</a> &amp;spr);
<a name="l00422"></a>00422 
<a name="l00423"></a>00423         <span class="keywordtype">void</span> pruneSubtree(<a class="code" href="classPhyloNode.html">PhyloNode</a> *node, <a class="code" href="classPhyloNode.html">PhyloNode</a> *dad, <a class="code" href="structPruningInfo.html">PruningInfo</a> &amp;info);
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         <span class="keywordtype">void</span> regraftSubtree(<a class="code" href="structPruningInfo.html">PruningInfo</a> &amp;info, 
<a name="l00426"></a>00426                 <a class="code" href="classPhyloNode.html">PhyloNode</a> *in_node, <a class="code" href="classPhyloNode.html">PhyloNode</a> *in_dad);
<a name="l00427"></a>00427 
<a name="l00431"></a><a class="code" href="classPhyloTree.html#a155032795a2a06262959ecba6fa1761b">00431</a>         <a class="code" href="classAlignment.html">Alignment</a> *<a class="code" href="classPhyloTree.html#a155032795a2a06262959ecba6fa1761b">aln</a>;
<a name="l00432"></a>00432 
<a name="l00436"></a><a class="code" href="classPhyloTree.html#ab17482e0cf6b9ea6def40d2c49bf0f3a">00436</a>         <span class="keywordtype">bool</span> <a class="code" href="classPhyloTree.html#ab17482e0cf6b9ea6def40d2c49bf0f3a">optimize_by_newton</a>;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 <span class="keyword">protected</span>:
<a name="l00439"></a>00439 
<a name="l00445"></a>00445         <span class="keywordtype">void</span> <a class="code" href="classPhyloTree.html#a5a35504080c18e60b3a3019c8d457253">assignLeafNames</a>(<a class="code" href="classNode.html">Node</a> *node = NULL, <a class="code" href="classNode.html">Node</a> *dad = NULL);
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 
<a name="l00451"></a><a class="code" href="classPhyloTree.html#affd265bc9cd055d0f59bfda46c98387b">00451</a>         <a class="code" href="classSubstModel.html">SubstModel</a> *<a class="code" href="classPhyloTree.html#affd265bc9cd055d0f59bfda46c98387b">model</a>;
<a name="l00452"></a>00452 
<a name="l00456"></a><a class="code" href="classPhyloTree.html#a9b7513b9bfee50bcd6cbe97a87366c4d">00456</a>         <a class="code" href="classRateHeterogeneity.html">RateHeterogeneity</a> *<a class="code" href="classPhyloTree.html#a9b7513b9bfee50bcd6cbe97a87366c4d">site_rate</a>;
<a name="l00457"></a>00457 
<a name="l00461"></a><a class="code" href="classPhyloTree.html#a9a11206ad156f382ee0db5f92dd399ce">00461</a>         <a class="code" href="classPhyloNeighbor.html">PhyloNeighbor</a> *<a class="code" href="classPhyloTree.html#a9a11206ad156f382ee0db5f92dd399ce">current_it</a>;
<a name="l00465"></a><a class="code" href="classPhyloTree.html#a5016a4372500fe919bfa09b713cd2344">00465</a>         <a class="code" href="classPhyloNeighbor.html">PhyloNeighbor</a> *<a class="code" href="classPhyloTree.html#a5016a4372500fe919bfa09b713cd2344">current_it_back</a>;
<a name="l00466"></a>00466 
<a name="l00470"></a><a class="code" href="classPhyloTree.html#a0ec867545e10bf1a45c938ed5c4a43f1">00470</a>         <a class="code" href="classSPRMoves.html">SPRMoves</a> <a class="code" href="classPhyloTree.html#a0ec867545e10bf1a45c938ed5c4a43f1">spr_moves</a>;
<a name="l00471"></a>00471 
<a name="l00475"></a><a class="code" href="classPhyloTree.html#a63a5b49b525b22534b525d7a35e663c7">00475</a>         <span class="keywordtype">int</span> <a class="code" href="classPhyloTree.html#a63a5b49b525b22534b525d7a35e663c7">spr_radius</a>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 };
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="preprocessor">#endif</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Nov 26 16:11:33 2009 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
