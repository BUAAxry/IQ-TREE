\hypertarget{classRateGamma}{
\section{RateGamma Class Reference}
\label{classRateGamma}\index{RateGamma@{RateGamma}}
}


{\ttfamily \#include $<$rategamma.h$>$}Inheritance diagram for RateGamma::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4cm]{classRateGamma}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classRateGamma_a040b97ec98732b29809b6cd03055b441}{RateGamma} (int ncat, \hyperlink{classPhyloTree}{PhyloTree} $\ast$tree)
\item 
virtual \hyperlink{classRateGamma_a5989cd3261ba9ae18d3fd23f532b74e2}{$\sim$RateGamma} ()
\item 
virtual int \hyperlink{classRateGamma_a115dac63aaa8fc7ac256304506ef3307}{getNRate} ()
\item 
virtual double \hyperlink{classRateGamma_a2e459469fd578b9d5d8bb18000d9d1d9}{getRate} (int category)
\item 
void \hyperlink{classRateGamma_a487fec4116b061846ec8cf1dd5d5b43f}{computeRates} ()
\item 
virtual double \hyperlink{classRateGamma_aadba870d743295ef057f9c78ac7fdd06}{optimizeParameters} ()
\item 
virtual double \hyperlink{classRateGamma_a24e01b7ec0d9170ceebcf03b603b2bbb}{computeFunction} (double shape)
\item 
virtual int \hyperlink{classRateGamma_af271c0115c8a81ff6fac32d1cfef6187}{getNDim} ()
\item 
virtual void \hyperlink{classRateGamma_a835bb210fd8fb4552613fe49875cbfb5}{writeInfo} (ostream \&out)
\item 
virtual void \hyperlink{classRateGamma_a88ffb33131f2cf23cfd0525e092c7717}{writeParameters} (ostream \&out)
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classRateGamma_af08e1d7ff25ba462357db3f019617658}{
double {\bfseries cmpPerPointGamma} (const double prob, const double shape)}
\label{classRateGamma_af08e1d7ff25ba462357db3f019617658}

\item 
double \hyperlink{classRateGamma_a10e81681fe39582f6ed6c89b554fbeab}{cmpLnGamma} (double alpha)
\item 
double \hyperlink{classRateGamma_a30b08c43d6ca5266a801b825baa3ac1f}{cmpIncompleteGamma} (double x, double alpha, double ln\_\-gamma\_\-alpha)
\item 
double \hyperlink{classRateGamma_a65fda804b83f71c65b365c16a6e01e4b}{cmpPointNormal} (double prob)
\item 
double \hyperlink{classRateGamma_ac7740803fb3a31189a17d9173848774b}{cmpPointChi2} (double prob, double v)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classRateGamma_adeaf25f809c07e9fdf368bece8190900}{ncategory}
\item 
double $\ast$ \hyperlink{classRateGamma_a9f72703c81eb78da12198c44fcf7d68c}{rates}
\item 
double \hyperlink{classRateGamma_a88433a75c040757da67d9007c2ab9db4}{gamma\_\-shape}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Discrete gamma distributed site-\/rate model from Yang 1994

\begin{DoxyAuthor}{Author}
BUI Quang Minh $<$\href{mailto:minh.bui@univie.ac.at}{\tt minh.bui@univie.ac.at}$>$ 
\end{DoxyAuthor}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classRateGamma_a040b97ec98732b29809b6cd03055b441}{
\index{RateGamma@{RateGamma}!RateGamma@{RateGamma}}
\index{RateGamma@{RateGamma}!RateGamma@{RateGamma}}
\subsubsection[{RateGamma}]{\setlength{\rightskip}{0pt plus 5cm}RateGamma::RateGamma (int {\em ncat}, \/  {\bf PhyloTree} $\ast$ {\em tree})}}
\label{classRateGamma_a040b97ec98732b29809b6cd03055b441}
constructor 
\begin{DoxyParams}{Parameters}
\item[{\em ncat}]number of rate categories \item[{\em tree}]associated phylogenetic tree \end{DoxyParams}
\hypertarget{classRateGamma_a5989cd3261ba9ae18d3fd23f532b74e2}{
\index{RateGamma@{RateGamma}!$\sim$RateGamma@{$\sim$RateGamma}}
\index{$\sim$RateGamma@{$\sim$RateGamma}!RateGamma@{RateGamma}}
\subsubsection[{$\sim$RateGamma}]{\setlength{\rightskip}{0pt plus 5cm}RateGamma::$\sim$RateGamma ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classRateGamma_a5989cd3261ba9ae18d3fd23f532b74e2}
destructor 

\subsection{Member Function Documentation}
\hypertarget{classRateGamma_a30b08c43d6ca5266a801b825baa3ac1f}{
\index{RateGamma@{RateGamma}!cmpIncompleteGamma@{cmpIncompleteGamma}}
\index{cmpIncompleteGamma@{cmpIncompleteGamma}!RateGamma@{RateGamma}}
\subsubsection[{cmpIncompleteGamma}]{\setlength{\rightskip}{0pt plus 5cm}double RateGamma::cmpIncompleteGamma (double {\em x}, \/  double {\em alpha}, \/  double {\em ln\_\-gamma\_\-alpha})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classRateGamma_a30b08c43d6ca5266a801b825baa3ac1f}
returns the incomplete gamma ratio I(x,alpha) where x is the upper limit of the integration and alpha is the shape parameter. returns (-\/1) if in error (1) series expansion if (alpha$>$x $|$$|$ x$<$=1) (2) continued fraction otherwise RATNEST FORTRAN by Bhattacharjee GP (1970) The incomplete gamma integral. Applied Statistics, 19: 285-\/287 (AS32) \hypertarget{classRateGamma_a10e81681fe39582f6ed6c89b554fbeab}{
\index{RateGamma@{RateGamma}!cmpLnGamma@{cmpLnGamma}}
\index{cmpLnGamma@{cmpLnGamma}!RateGamma@{RateGamma}}
\subsubsection[{cmpLnGamma}]{\setlength{\rightskip}{0pt plus 5cm}double RateGamma::cmpLnGamma (double {\em alpha})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classRateGamma_a10e81681fe39582f6ed6c89b554fbeab}
returns ln(gamma(alpha)) for alpha$>$0, accurate to 10 decimal places. Stirling's formula is used for the central polynomial part of the procedure. Pike MC \& Hill ID (1966) Algorithm 291: Logarithm of the gamma function. Communications of the Association for Computing Machinery, 9:684 \hypertarget{classRateGamma_ac7740803fb3a31189a17d9173848774b}{
\index{RateGamma@{RateGamma}!cmpPointChi2@{cmpPointChi2}}
\index{cmpPointChi2@{cmpPointChi2}!RateGamma@{RateGamma}}
\subsubsection[{cmpPointChi2}]{\setlength{\rightskip}{0pt plus 5cm}double RateGamma::cmpPointChi2 (double {\em prob}, \/  double {\em v})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classRateGamma_ac7740803fb3a31189a17d9173848774b}
returns z so that Prob\{x$<$z\}=prob where x is Chi2 distributed with df=v returns -\/1 if in error. 0.000002$<$prob$<$0.999998 RATNEST FORTRAN by Best DJ \& Roberts DE (1975) The percentage points of the Chi2 distribution. Applied Statistics 24: 385-\/388. (AS91) Converted into C by Ziheng Yang, Oct. 1993. \hypertarget{classRateGamma_a65fda804b83f71c65b365c16a6e01e4b}{
\index{RateGamma@{RateGamma}!cmpPointNormal@{cmpPointNormal}}
\index{cmpPointNormal@{cmpPointNormal}!RateGamma@{RateGamma}}
\subsubsection[{cmpPointNormal}]{\setlength{\rightskip}{0pt plus 5cm}double RateGamma::cmpPointNormal (double {\em prob})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classRateGamma_a65fda804b83f71c65b365c16a6e01e4b}
functions concerning the CDF and percentage points of the gamma and Chi2 distribution returns z so that Prob\{x$<$z\}=prob where x $\sim$ N(0,1) and (1e-\/12)$<$prob$<$1-\/(1e-\/12) returns (-\/9999) if in error Odeh RE \& Evans JO (1974) The percentage points of the normal distribution. Applied Statistics 22: 96-\/97 (AS70)

Newer methods: Wichura MJ (1988) Algorithm AS 241: the percentage points of the normal distribution. 37: 477-\/484. Beasley JD \& Springer SG (1977). Algorithm AS 111: the percentage points of the normal distribution. 26: 118-\/121. \hypertarget{classRateGamma_a24e01b7ec0d9170ceebcf03b603b2bbb}{
\index{RateGamma@{RateGamma}!computeFunction@{computeFunction}}
\index{computeFunction@{computeFunction}!RateGamma@{RateGamma}}
\subsubsection[{computeFunction}]{\setlength{\rightskip}{0pt plus 5cm}double RateGamma::computeFunction (double {\em shape})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classRateGamma_a24e01b7ec0d9170ceebcf03b603b2bbb}
override function from \hyperlink{classOptimization}{Optimization} class, used by the \hyperlink{classOptimization_a59ccdfae81744716ce48226da029d470}{minimizeOneDimen()} to optimize gamma shape parameter 

Reimplemented from \hyperlink{classOptimization_ad7ca7b884076f8c76312d516e23c6609}{Optimization}.

Reimplemented in \hyperlink{classRateGammaInvar_a48fde92a023867c5d0656572f8dc0f71}{RateGammaInvar}.\hypertarget{classRateGamma_a487fec4116b061846ec8cf1dd5d5b43f}{
\index{RateGamma@{RateGamma}!computeRates@{computeRates}}
\index{computeRates@{computeRates}!RateGamma@{RateGamma}}
\subsubsection[{computeRates}]{\setlength{\rightskip}{0pt plus 5cm}void RateGamma::computeRates ()}}
\label{classRateGamma_a487fec4116b061846ec8cf1dd5d5b43f}
discrete Gamma according to Yang 1994 (JME 39:306-\/314). It takes 'ncategory' and 'gamma\_\-shape' variables as input. On output, it write to 'rates' variable. \hypertarget{classRateGamma_af271c0115c8a81ff6fac32d1cfef6187}{
\index{RateGamma@{RateGamma}!getNDim@{getNDim}}
\index{getNDim@{getNDim}!RateGamma@{RateGamma}}
\subsubsection[{getNDim}]{\setlength{\rightskip}{0pt plus 5cm}virtual int RateGamma::getNDim ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classRateGamma_af271c0115c8a81ff6fac32d1cfef6187}
return the number of dimensions 

Reimplemented from \hyperlink{classOptimization_a6d04cefb0969f3cac9b607aa1412eb57}{Optimization}.

Reimplemented in \hyperlink{classRateGammaInvar_a4f276d1639a79eece217b365439049c7}{RateGammaInvar}.\hypertarget{classRateGamma_a115dac63aaa8fc7ac256304506ef3307}{
\index{RateGamma@{RateGamma}!getNRate@{getNRate}}
\index{getNRate@{getNRate}!RateGamma@{RateGamma}}
\subsubsection[{getNRate}]{\setlength{\rightskip}{0pt plus 5cm}virtual int RateGamma::getNRate ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classRateGamma_a115dac63aaa8fc7ac256304506ef3307}
\begin{DoxyReturn}{Returns}
the number of rate categories 
\end{DoxyReturn}


Reimplemented from \hyperlink{classRateHeterogeneity_ac61808650eab5d2187f3cc9b20694f80}{RateHeterogeneity}.\hypertarget{classRateGamma_a2e459469fd578b9d5d8bb18000d9d1d9}{
\index{RateGamma@{RateGamma}!getRate@{getRate}}
\index{getRate@{getRate}!RateGamma@{RateGamma}}
\subsubsection[{getRate}]{\setlength{\rightskip}{0pt plus 5cm}virtual double RateGamma::getRate (int {\em category})\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classRateGamma_a2e459469fd578b9d5d8bb18000d9d1d9}

\begin{DoxyParams}{Parameters}
\item[{\em category}]category ID from 0 to category-\/1 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
the rate of the specified category 
\end{DoxyReturn}


Reimplemented from \hyperlink{classRateHeterogeneity_a87546419c324a62d31055d564ea07f5e}{RateHeterogeneity}.\hypertarget{classRateGamma_aadba870d743295ef057f9c78ac7fdd06}{
\index{RateGamma@{RateGamma}!optimizeParameters@{optimizeParameters}}
\index{optimizeParameters@{optimizeParameters}!RateGamma@{RateGamma}}
\subsubsection[{optimizeParameters}]{\setlength{\rightskip}{0pt plus 5cm}double RateGamma::optimizeParameters ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classRateGamma_aadba870d743295ef057f9c78ac7fdd06}
optimize parameters. Default is to optimize gamma shape \begin{DoxyReturn}{Returns}
the best likelihood 
\end{DoxyReturn}


Reimplemented from \hyperlink{classRateHeterogeneity_a1305d5b8481dd5a2482917ddb5fe57bd}{RateHeterogeneity}.

Reimplemented in \hyperlink{classRateGammaInvar_ab72a2559cea978d312a243d521c2abef}{RateGammaInvar}.\hypertarget{classRateGamma_a835bb210fd8fb4552613fe49875cbfb5}{
\index{RateGamma@{RateGamma}!writeInfo@{writeInfo}}
\index{writeInfo@{writeInfo}!RateGamma@{RateGamma}}
\subsubsection[{writeInfo}]{\setlength{\rightskip}{0pt plus 5cm}void RateGamma::writeInfo (ostream \& {\em out})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classRateGamma_a835bb210fd8fb4552613fe49875cbfb5}
write information 
\begin{DoxyParams}{Parameters}
\item[{\em out}]output stream \end{DoxyParams}


Reimplemented from \hyperlink{classRateHeterogeneity_a520772859d465036b6620bdbf2977efe}{RateHeterogeneity}.

Reimplemented in \hyperlink{classRateGammaInvar_a428c3ac79ba1bf28da546f602d4b0f7b}{RateGammaInvar}.\hypertarget{classRateGamma_a88ffb33131f2cf23cfd0525e092c7717}{
\index{RateGamma@{RateGamma}!writeParameters@{writeParameters}}
\index{writeParameters@{writeParameters}!RateGamma@{RateGamma}}
\subsubsection[{writeParameters}]{\setlength{\rightskip}{0pt plus 5cm}void RateGamma::writeParameters (ostream \& {\em out})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classRateGamma_a88ffb33131f2cf23cfd0525e092c7717}
write parameters, used with modeltest 
\begin{DoxyParams}{Parameters}
\item[{\em out}]output stream \end{DoxyParams}


Reimplemented from \hyperlink{classRateHeterogeneity_ad2832e686971cf1f2cac2a6f842a3550}{RateHeterogeneity}.

Reimplemented in \hyperlink{classRateGammaInvar_a13b6629de9e3579aacff555f1bd76db5}{RateGammaInvar}.

\subsection{Member Data Documentation}
\hypertarget{classRateGamma_a88433a75c040757da67d9007c2ab9db4}{
\index{RateGamma@{RateGamma}!gamma\_\-shape@{gamma\_\-shape}}
\index{gamma\_\-shape@{gamma\_\-shape}!RateGamma@{RateGamma}}
\subsubsection[{gamma\_\-shape}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf RateGamma::gamma\_\-shape}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classRateGamma_a88433a75c040757da67d9007c2ab9db4}
the gamma shape parameter 'alpha' \hypertarget{classRateGamma_adeaf25f809c07e9fdf368bece8190900}{
\index{RateGamma@{RateGamma}!ncategory@{ncategory}}
\index{ncategory@{ncategory}!RateGamma@{RateGamma}}
\subsubsection[{ncategory}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf RateGamma::ncategory}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classRateGamma_adeaf25f809c07e9fdf368bece8190900}
number of rate categories \hypertarget{classRateGamma_a9f72703c81eb78da12198c44fcf7d68c}{
\index{RateGamma@{RateGamma}!rates@{rates}}
\index{rates@{rates}!RateGamma@{RateGamma}}
\subsubsection[{rates}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ {\bf RateGamma::rates}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classRateGamma_a9f72703c81eb78da12198c44fcf7d68c}
rates, containing ncategory elements 

The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
src/rategamma.h\item 
src/rategamma.cpp\end{DoxyCompactItemize}
