\hypertarget{classSubstModel}{
\section{SubstModel Class Reference}
\label{classSubstModel}\index{SubstModel@{SubstModel}}
}


{\ttfamily \#include $<$substmodel.h$>$}Inheritance diagram for SubstModel::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4cm]{classSubstModel}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classSubstModel_ad9629506c448db08c094f65569795242}{SubstModel} (int nstates)
\item 
virtual void \hyperlink{classSubstModel_a83997a2aaea95f2c994d88a9d1cb190e}{computeTransMatrix} (double time, double $\ast$trans\_\-matrix)
\item 
virtual void \hyperlink{classSubstModel_a18f98e25cacbd18e1b64b25d10a3e11f}{getStateFrequency} (double $\ast$state\_\-freq)
\item 
virtual double $\ast$ \hyperlink{classSubstModel_a3bea68a055833acb9dad99cb529681e5}{newTransMatrix} ()
\item 
virtual void \hyperlink{classSubstModel_ada88db5c6befc33de5ddb590667ba865}{computeTransDerv} (double time, double $\ast$trans\_\-matrix, double $\ast$trans\_\-derv1, double $\ast$trans\_\-derv2)
\item 
virtual double \hyperlink{classSubstModel_aa2d4bd724a699264b40dd5b2d129e29f}{optimizeParameters} ()
\item 
virtual void \hyperlink{classSubstModel_ac81144591a9eb6b6d9abc9e873a20af6}{writeInfo} (ostream \&out)
\item 
virtual \hyperlink{classSubstModel_accfa9c36ec87262ca1479fcdb4c95c3d}{$\sim$SubstModel} ()
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classSubstModel_abc3ccd407830f359e794ac3fd51a5559}{num\_\-states}
\item 
string \hyperlink{classSubstModel_a28fd43ca59508025c8faa9365861a3d8}{name}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Substitution model abstract class

\begin{DoxyAuthor}{Author}
BUI Quang Minh, Steffen Klaere, Arndt von Haeseler $<$\href{mailto:minh.bui@univie.ac.at}{\tt minh.bui@univie.ac.at}$>$ 
\end{DoxyAuthor}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classSubstModel_ad9629506c448db08c094f65569795242}{
\index{SubstModel@{SubstModel}!SubstModel@{SubstModel}}
\index{SubstModel@{SubstModel}!SubstModel@{SubstModel}}
\subsubsection[{SubstModel}]{\setlength{\rightskip}{0pt plus 5cm}SubstModel::SubstModel (int {\em nstates})}}
\label{classSubstModel_ad9629506c448db08c094f65569795242}
constructor 
\begin{DoxyParams}{Parameters}
\item[{\em nstates}]number of states, e.g. 4 for DNA, 20 for proteins. \end{DoxyParams}
\hypertarget{classSubstModel_accfa9c36ec87262ca1479fcdb4c95c3d}{
\index{SubstModel@{SubstModel}!$\sim$SubstModel@{$\sim$SubstModel}}
\index{$\sim$SubstModel@{$\sim$SubstModel}!SubstModel@{SubstModel}}
\subsubsection[{$\sim$SubstModel}]{\setlength{\rightskip}{0pt plus 5cm}SubstModel::$\sim$SubstModel ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSubstModel_accfa9c36ec87262ca1479fcdb4c95c3d}
destructor 

\subsection{Member Function Documentation}
\hypertarget{classSubstModel_ada88db5c6befc33de5ddb590667ba865}{
\index{SubstModel@{SubstModel}!computeTransDerv@{computeTransDerv}}
\index{computeTransDerv@{computeTransDerv}!SubstModel@{SubstModel}}
\subsubsection[{computeTransDerv}]{\setlength{\rightskip}{0pt plus 5cm}void SubstModel::computeTransDerv (double {\em time}, \/  double $\ast$ {\em trans\_\-matrix}, \/  double $\ast$ {\em trans\_\-derv1}, \/  double $\ast$ {\em trans\_\-derv2})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSubstModel_ada88db5c6befc33de5ddb590667ba865}
compute the transition probability matrix.and the derivative 1 and 2 
\begin{DoxyParams}{Parameters}
\item[{\em time}]time between two events \item[{\em trans\_\-matrix}](OUT) the transition matrix between all pairs of states. Assume trans\_\-matrix has size of num\_\-states $\ast$ num\_\-states. \item[{\em trans\_\-derv1}](OUT) the 1st derivative matrix between all pairs of states. \item[{\em trans\_\-derv2}](OUT) the 2nd derivative matrix between all pairs of states. \end{DoxyParams}


Reimplemented in \hyperlink{classGTRModel_a9f6c7532d57b0e41d95dd95c5972cf5b}{GTRModel}.\hypertarget{classSubstModel_a83997a2aaea95f2c994d88a9d1cb190e}{
\index{SubstModel@{SubstModel}!computeTransMatrix@{computeTransMatrix}}
\index{computeTransMatrix@{computeTransMatrix}!SubstModel@{SubstModel}}
\subsubsection[{computeTransMatrix}]{\setlength{\rightskip}{0pt plus 5cm}void SubstModel::computeTransMatrix (double {\em time}, \/  double $\ast$ {\em trans\_\-matrix})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSubstModel_a83997a2aaea95f2c994d88a9d1cb190e}
compute the transition probability matrix. One should override this function when defining new model. The default is the Juke-\/Cantor model, valid for all kind of data (DNA, AA, Codon, etc) 
\begin{DoxyParams}{Parameters}
\item[{\em time}]time between two events \item[{\em trans\_\-matrix}](OUT) the transition matrix between all pairs of states. Assume trans\_\-matrix has size of num\_\-states $\ast$ num\_\-states. \end{DoxyParams}


Reimplemented in \hyperlink{classGTRModel_aa779b66b3824c4e956db7b56dee668c2}{GTRModel}.\hypertarget{classSubstModel_a18f98e25cacbd18e1b64b25d10a3e11f}{
\index{SubstModel@{SubstModel}!getStateFrequency@{getStateFrequency}}
\index{getStateFrequency@{getStateFrequency}!SubstModel@{SubstModel}}
\subsubsection[{getStateFrequency}]{\setlength{\rightskip}{0pt plus 5cm}void SubstModel::getStateFrequency (double $\ast$ {\em state\_\-freq})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSubstModel_a18f98e25cacbd18e1b64b25d10a3e11f}
compute the state frequency vector. One should override this function when defining new model. The default is equal state sequency, valid for all kind of data. 
\begin{DoxyParams}{Parameters}
\item[{\em state\_\-freq}](OUT) state frequency vector. Assume state\_\-freq has size of num\_\-states \end{DoxyParams}


Reimplemented in \hyperlink{classGTRModel_aa7cdd1fb6852faccc185284c075c918b}{GTRModel}.\hypertarget{classSubstModel_a3bea68a055833acb9dad99cb529681e5}{
\index{SubstModel@{SubstModel}!newTransMatrix@{newTransMatrix}}
\index{newTransMatrix@{newTransMatrix}!SubstModel@{SubstModel}}
\subsubsection[{newTransMatrix}]{\setlength{\rightskip}{0pt plus 5cm}double $\ast$ SubstModel::newTransMatrix ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSubstModel_a3bea68a055833acb9dad99cb529681e5}
allocate memory for a transition matrix. One should override this function when defining new model such as Gamma model. The default is to allocate a double vector of size num\_\-states $\ast$ num\_\-states. This is equivalent to the memory needed by a square matrix. \begin{DoxyReturn}{Returns}
the pointer to the newly allocated transition matrix 
\end{DoxyReturn}
\hypertarget{classSubstModel_aa2d4bd724a699264b40dd5b2d129e29f}{
\index{SubstModel@{SubstModel}!optimizeParameters@{optimizeParameters}}
\index{optimizeParameters@{optimizeParameters}!SubstModel@{SubstModel}}
\subsubsection[{optimizeParameters}]{\setlength{\rightskip}{0pt plus 5cm}virtual double SubstModel::optimizeParameters ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classSubstModel_aa2d4bd724a699264b40dd5b2d129e29f}
optimize model parameters. One should override this function when defining new model. The default does nothing since it is a Juke-\/Cantor type model, hence no parameters involved. \begin{DoxyReturn}{Returns}
the best likelihood 
\end{DoxyReturn}


Reimplemented in \hyperlink{classGTRModel_a01c47ec7ac4b856e60aa3e4339e0044a}{GTRModel}.\hypertarget{classSubstModel_ac81144591a9eb6b6d9abc9e873a20af6}{
\index{SubstModel@{SubstModel}!writeInfo@{writeInfo}}
\index{writeInfo@{writeInfo}!SubstModel@{SubstModel}}
\subsubsection[{writeInfo}]{\setlength{\rightskip}{0pt plus 5cm}virtual void SubstModel::writeInfo (ostream \& {\em out})\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classSubstModel_ac81144591a9eb6b6d9abc9e873a20af6}
write information 
\begin{DoxyParams}{Parameters}
\item[{\em out}]output stream \end{DoxyParams}


Reimplemented in \hyperlink{classGTRModel_a233f9b473e4e3c549d801ff8a084e35e}{GTRModel}.

\subsection{Member Data Documentation}
\hypertarget{classSubstModel_a28fd43ca59508025c8faa9365861a3d8}{
\index{SubstModel@{SubstModel}!name@{name}}
\index{name@{name}!SubstModel@{SubstModel}}
\subsubsection[{name}]{\setlength{\rightskip}{0pt plus 5cm}string {\bf SubstModel::name}}}
\label{classSubstModel_a28fd43ca59508025c8faa9365861a3d8}
name of the model \hypertarget{classSubstModel_abc3ccd407830f359e794ac3fd51a5559}{
\index{SubstModel@{SubstModel}!num\_\-states@{num\_\-states}}
\index{num\_\-states@{num\_\-states}!SubstModel@{SubstModel}}
\subsubsection[{num\_\-states}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf SubstModel::num\_\-states}}}
\label{classSubstModel_abc3ccd407830f359e794ac3fd51a5559}
number of states 

The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
src/substmodel.h\item 
src/substmodel.cpp\end{DoxyCompactItemize}
